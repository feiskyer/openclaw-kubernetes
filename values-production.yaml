# Production values for OpenClaw.
# This is a YAML-formatted file.
# Use this file for production deployments with high availability and security.

## @section Deployment Settings

# -- Number of replicas for the OpenClaw gateway
# Note: Must be 1 as OpenClaw maintains state and is a single-instance app
replicaCount: 1

## @section Image Settings

# -- Docker image configuration
image:
  # -- Image repository including registry
  repository: ghcr.io/feiskyer/openclaw-gateway
  # -- Image tag (defaults to Chart appVersion if not set)
  tag: ""
  # -- Image pull policy
  pullPolicy: Always

# -- Image pull secrets for private registries
imagePullSecrets: []

## @section Naming

# -- String to override the default name
nameOverride: ""
# -- String to override the default fullname
fullnameOverride: ""

## @section Service Account

# -- Service account configuration
serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Automount service account token
  automountServiceAccountToken: false
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use
  name: ""

## @section Pod Settings

# -- Pod annotations
podAnnotations: {}

# -- Pod security context
podSecurityContext:
  fsGroup: 1024
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

# -- Container security context
securityContext:
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1024
  allowPrivilegeEscalation: false
  seccompProfile:
    type: RuntimeDefault

## @section Service Settings

# -- Service configuration
service:
  # -- Service type
  type: ClusterIP
  # -- Service port
  port: 18789
  # -- Target port on the container
  targetPort: 18789
  # -- Service annotations
  annotations: {}

## @section Ingress Settings

# -- Ingress configuration
ingress:
  # -- Enable ingress
  enabled: true
  # -- Ingress class name
  className: nginx
  # -- Additional annotations for the ingress
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-http-version: "1.1"
    nginx.ingress.kubernetes.io/proxy-buffering: "off"
    nginx.ingress.kubernetes.io/proxy-body-size: "100m"
    nginx.ingress.kubernetes.io/configuration-snippet: |
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection "upgrade";
  # -- Ingress hosts
  hosts:
    - host: openclaw.example.com
      paths:
        - path: /
          pathType: ImplementationSpecific
  # -- TLS configuration
  tls:
    - secretName: openclaw-tls
      hosts:
        - openclaw.example.com

## @section Resource Settings

# -- Resource requests and limits
resources:
  limits:
    cpu: 1000m
    memory: 2Gi
  requests:
    cpu: 500m
    memory: 1Gi

## @section Autoscaling

# -- Horizontal Pod Autoscaler configuration
# NOTE: Not recommended for OpenClaw as it's a single-instance StatefulSet
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 1
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

## @section Scheduling

# -- Node selector
nodeSelector: {}

# -- Tolerations for pod scheduling
tolerations: []

# -- Affinity rules for pod scheduling
# Pod anti-affinity ensures pods are spread across different nodes
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - openclaw
          topologyKey: kubernetes.io/hostname

# -- Pod topology spread constraints
topologySpreadConstraints: []

## @section Persistence

# -- Persistent Volume configuration
persistence:
  # -- Enable persistent storage
  enabled: true
  # -- Storage class name (empty for default)
  storageClass: "fast-ssd"
  # -- Access mode for the PVC
  accessMode: ReadWriteOnce
  # -- Size of the persistent volume
  size: 10Gi
  # -- Existing PVC to use
  existingClaim: ""
  # -- Annotations for the PVC
  annotations:
    backup.velero.io/backup-volumes: data
  # -- Retain policy for the PVC
  retainPolicy: Retain
  # -- Use StatefulSet volumeClaimTemplates
  useStatefulSetVolumeClaim: true

## @section OpenClaw Configuration

# -- OpenClaw configuration
openclaw:
  # -- OpenClaw gateway configuration (openclaw.json content)
  config:
    gateway:
      port: 18789
      host: "0.0.0.0"
    logging:
      level: "info"

## @section Secrets

# -- Secrets configuration
secrets:
  # -- Use existing secret instead of creating one
  existingSecret: ""
  # -- Secret annotations
  annotations: {}
  # -- Discord bot token
  discordBotToken: ""
  # -- Telegram bot token
  telegramBotToken: ""
  # -- Slack bot token
  slackBotToken: ""
  # -- Slack app token
  slackAppToken: ""
  # -- Gateway authentication token
  openclawGatewayToken: ""

## @section Probes

# -- Liveness probe configuration
livenessProbe:
  enabled: true
  exec:
    command:
      - node
      - dist/index.js
      - health
  initialDelaySeconds: 30
  periodSeconds: 30
  timeoutSeconds: 10
  failureThreshold: 3
  successThreshold: 1

# -- Readiness probe configuration
readinessProbe:
  enabled: true
  exec:
    command:
      - node
      - dist/index.js
      - health
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
  successThreshold: 1

# -- Startup probe configuration
startupProbe:
  enabled: false
  exec:
    command:
      - node
      - dist/index.js
      - health
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30
  successThreshold: 1

## @section Extra Configuration

# -- Extra environment variables
extraEnv: []

# -- Extra environment variables from secrets/configmaps
extraEnvFrom: []

# -- Extra volume mounts for the container
extraVolumeMounts: []

# -- Extra volumes for the pod
extraVolumes: []

# -- Init containers
initContainers: []

# -- Sidecar containers
sidecars: []

## @section LiteLLM Proxy

# -- LiteLLM Proxy configuration
litellm:
  # -- Enable LiteLLM proxy deployment
  enabled: true
  # -- Number of replicas
  replicaCount: 1
  # -- LiteLLM image configuration
  image:
    repository: ghcr.io/berriai/litellm
    tag: main-latest
    pullPolicy: IfNotPresent
  # -- Service configuration
  service:
    type: ClusterIP
    port: 4000
    targetPort: 4000
    annotations: {}
  # -- Resource requests and limits
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 200m
      memory: 512Mi
  # -- Model to proxy through LiteLLM
  model: claude-opus-4.6
  # -- LiteLLM provider and credentials (set via --set or external secret management)
  secrets:
    provider: github_copilot
    apiKey: ""
    apiBase: ""
  # -- Persistent storage for LiteLLM data
  persistence:
    enabled: true
    storageClass: "fast-ssd"
    accessMode: ReadWriteOnce
    size: 2Gi
    mountPath: /home/litellm/.config/litellm
    existingClaim: ""
  # -- Extra environment variables
  extraEnv: []
  # -- Override the default LiteLLM config entirely
  configOverride: ""

## @section Pod Disruption Budget

# -- Pod Disruption Budget configuration
podDisruptionBudget:
  # -- Enable Pod Disruption Budget
  enabled: false
  # -- Minimum available pods (number or percentage)
  minAvailable: 1
  # -- Maximum unavailable pods (number or percentage)
  # maxUnavailable: 1
